<pre>
  BIP: ?
  Title: Malleability fix
  Author: Tomas van der Wansem <tomas@tomasvdw.nl>
  Status: Draft
  Created: 2016-12-14
</pre>

==Abstract==

This document proposes a change in the protocol, that allows the creation of non-malleable transactions.

==Motivation==

The advantages of creating non-malleable transactions are well known and discussed elsewhere [1]

==Definitions==

ITXID - Immutable Transaction ID: The double SHA256 taken from a transaction after stripping it of all input scripts including their length prefixes.

==Specification==

If a transaction has its version field set to 3 or higher, any previous-tx field of any transaction that references it
must use the ITXID of the transaction in the previous-tx field instead of the TXID.

The TXID is still used in the previous-tx field if it points to a version 1 or 2 transaction and for construction of the merkle tree.

The TXID is also still passed in INV messages.

== Deployment ==

This BIP will be deployed by "version bits" BIP9. Bit and start dates TBD.

== Alternatives ==

* SegWit BIP 141 [2] also fixes malleability. It has the drawback that it fixes many things at once, which may make it difficult to reach consensus. For example, it introduces new limits that are difficult to reconcile with the Unlimited variants.
* Flexible Transactions [3] also fixes malleability. It has the drawback of introducing a new serialization format, which means that every software will need to support two very different formats indefinitely. This may be a high price to pay.


==References==

* [1] https://en.bitcoin.it/wiki/Transaction_Malleability
* [2] https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki
* [3] https://zander.github.io/posts/Flexible_Transactions/
